module.exports=[18622,(a,b,c)=>{b.exports=a.x("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js",()=>require("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js"))},42602,(a,b,c)=>{"use strict";b.exports=a.r(18622)},87924,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored["react-ssr"].ReactJsxRuntime},72131,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored["react-ssr"].React},60350,a=>{"use strict";var b=a.i(87924),c=a.i(72131);function d(){let a=(0,c.useRef)(null),d=(0,c.useRef)(null),e=(0,c.useRef)(null),f=(0,c.useRef)(!1),g=(0,c.useRef)([]),h=(0,c.useRef)([]),i=(0,c.useRef)(1);return(0,c.useEffect)(()=>{let b,c;async function j(){if(f.current)return;f.current=!0;let b=a.current,c=e.current;c.getContext("2d").drawImage(b,0,0,c.width,c.height),c.toBlob(async a=>{if(!a){f.current=!1;return}try{let b=new FormData;b.append("file",a,"frame.jpg");let c=await fetch("https://hallucination.calmwave-93bbec10.brazilsouth.azurecontainerapps.io/detect",{method:"POST",body:b}),d=(await c.json()).polygons??[];g.current=h.current.length?h.current:d,h.current=d,i.current=0}catch(a){console.error(a)}finally{f.current=!1}},"image/jpeg",.6)}return async function f(){let f=await navigator.mediaDevices.getUserMedia({video:{width:640,height:480}}),k=a.current;k.srcObject=f,k.onloadedmetadata=()=>{let f;k.play(),f=a.current,d.current.width=f.videoWidth,d.current.height=f.videoHeight,e.current.width=f.videoWidth,e.current.height=f.videoHeight,function a(){let b=d.current,e=b.getContext("2d");e.clearRect(0,0,b.width,b.height),e.strokeStyle="#00ff00",e.lineWidth=3,h.current.map((a,b)=>{var c,d;return c=g.current[b]??a,d=i.current,c&&c.length===a.length?c.map((b,c)=>{var e,f;return{x:(e=b.x,e+(a[c].x-e)*d),y:(f=b.y,f+(a[c].y-f)*d)}}):a}).forEach(a=>{e.beginPath(),a.forEach((a,c)=>{let d=a.x*b.width,f=a.y*b.height;0===c?e.moveTo(d,f):e.lineTo(d,f)}),e.closePath(),e.stroke()}),i.current=Math.min(i.current+.08,1),c=requestAnimationFrame(a)}(),b=setInterval(j,1e3)}}(),()=>{clearInterval(b),cancelAnimationFrame(c)}},[]),(0,b.jsxs)("div",{className:"relative w-[640px] h-[480px] bg-black",children:[(0,b.jsx)("video",{ref:a,className:"absolute top-0 left-0 w-full h-full object-cover rounded-xl",muted:!0,playsInline:!0,autoPlay:!0}),(0,b.jsx)("canvas",{ref:d,className:"absolute top-0 left-0 w-full h-full pointer-events-none"}),(0,b.jsx)("canvas",{ref:e,className:"hidden"})]})}function e({children:a}){return(0,b.jsxs)("div",{className:"relative hud-panel",children:[(0,b.jsx)("span",{className:"hud-corner top-left"}),(0,b.jsx)("span",{className:"hud-corner top-right"}),(0,b.jsx)("span",{className:"hud-corner bottom-left"}),(0,b.jsx)("span",{className:"hud-corner bottom-right"}),a]})}function f({demo:a=null}){let[d,f]=(0,c.useState)(0);return(0,c.useEffect)(()=>{let b;if(null!==a)return void f(a);let c=async()=>{try{let a=await fetch("https://hallucination.calmwave-93bbec10.brazilsouth.azurecontainerapps.io/status"),b=await a.json();f(b.people_detected??0)}catch{f(a=>a>=3?1:a+1)}};return c(),b=setInterval(c,4e3),()=>clearInterval(b)},[a]),(0,b.jsxs)(e,{children:[(0,b.jsx)("h2",{className:"text-xs text-green-400 uppercase tracking-widest",children:"People Detected"}),(0,b.jsx)("p",{className:"mt-4 text-5xl font-bold text-green-400",children:d}),(0,b.jsx)("p",{className:"mt-2 text-xs text-zinc-500",children:"Camera-based detection"})]})}function g({sceneState:a}){let c=function(a){switch(a){case"EMPTY_ENVIRONMENT":return{label:"No people detected",color:"text-green-400",border:"border-green-700"};case"SINGLE_PERSON_PRESENT":return{label:"One person detected",color:"text-green-300",border:"border-green-600"};case"MULTIPLE_PEOPLE_PRESENT":return{label:"Multiple people detected",color:"text-yellow-400",border:"border-yellow-600"};case"CROWD_ENVIRONMENT":return{label:"Crowded environment",color:"text-red-400",border:"border-red-700"};default:return{label:"Analyzing environment",color:"text-zinc-400",border:"border-zinc-700"}}}(a);return(0,b.jsxs)("div",{className:`rounded-xl border ${c.border} bg-zinc-950 p-6`,children:[(0,b.jsx)("h2",{className:"text-sm uppercase text-zinc-500",children:"Environment status"}),(0,b.jsx)("p",{className:`mt-4 text-xl font-semibold ${c.color}`,children:c.label})]})}let h="lumi";function i({peopleDetected:a,sceneState:d}){let e=(0,c.useRef)(null),f=(0,c.useRef)(null),g=(0,c.useRef)(!1),i=(0,c.useRef)(!1),[j,k]=(0,c.useState)("idle");async function l(b){let c=await fetch("https://hallucination.calmwave-93bbec10.brazilsouth.azurecontainerapps.io/voice",{method:"POST",headers:{"Content-Type":"application/json",Accept:"audio/mpeg"},body:JSON.stringify({text:b,people_detected:a,scene_state:d})});if(!c.ok)throw Error(`Voice API failed: ${c.status}`);return await c.blob()}function m(){g.current=!1,i.current=!1,k("idle")}return(0,b.jsxs)("button",{onClick:function(){if(g.current)return;let a=window.SpeechRecognition||window.webkitSpeechRecognition;if(!a)return void alert("Speech Recognition not supported");g.current=!0,i.current=!1;let b=new a;b.lang="en-US",b.continuous=!1,b.interimResults=!1,b.onresult=async a=>{if(i.current)return;i.current=!0;let c=a.results?.[0]?.[0]?.transcript?.trim().toLowerCase();if(!c||c===h)return void m();let d=c.startsWith(h)?c.replace(h,"").trim():c;if(!d)return void m();b.stop(),k("thinking");try{var e;let a,b;e=await l(d),k("speaking"),f.current&&(f.current.pause(),f.current.src="",f.current=null),a=URL.createObjectURL(e),f.current=b=new Audio(a),b.onended=()=>{URL.revokeObjectURL(a),m()},b.onerror=()=>{URL.revokeObjectURL(a),m()},b.play().catch(m)}catch(a){console.error("Voice error:",a),m()}},b.onerror=()=>{b.stop(),m()},e.current=b,k("listening"),b.start()},disabled:"idle"!==j,className:"w-full rounded-xl bg-blue-600 px-4 py-3 font-semibold disabled:opacity-50",children:["idle"===j&&"ðŸŽ™ Speak","listening"===j&&"ðŸ‘‚ Listening...","thinking"===j&&"ðŸ§  Thinking...","speaking"===j&&"ðŸ”Š Speaking..."]})}function j(){let[a,e]=(0,c.useState)(0),[h,j]=(0,c.useState)("UNKNOWN");return(0,c.useEffect)(()=>{let a=async()=>{try{let a=await fetch("https://hallucination.calmwave-93bbec10.brazilsouth.azurecontainerapps.io/status"),b=await a.json();e(b.people_detected??0),j(b.scene_state??"UNKNOWN")}catch{}};a();let b=setInterval(a,1e3);return()=>clearInterval(b)},[]),(0,b.jsxs)("main",{className:"min-h-screen bg-black text-white flex flex-col items-center gap-6 p-6",children:[(0,b.jsx)("h1",{className:"text-2xl font-bold",children:"Hallucination Checker â€” Interactive Demo"}),(0,b.jsx)(d,{}),(0,b.jsxs)("div",{className:"flex gap-4",children:[(0,b.jsx)(f,{demo:a}),(0,b.jsx)(g,{sceneState:h})]}),(0,b.jsx)(i,{peopleDetected:a,sceneState:h})]})}a.s(["default",()=>j],60350)}];

//# sourceMappingURL=%5Broot-of-the-server%5D__5b8bc4d3._.js.map